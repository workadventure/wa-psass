import"./modulepreload-polyfill-3cfb730f.js";import"./main-4ed993c7.js";import{c as A,d as E,h as r,r as i}from"./index-1817ae2d.js";async function g(s){const t=document.getElementById("characters"),e=document.createElement("div");e.classList.add("flex"),e.classList.add("flex-col"),e.classList.add("justify-center"),e.classList.add("items-center");const l=document.createElement("p");l.classList.add("text-white"),l.innerText=`${s.uuid===WA.player.uuid?"Vous":s.name}${s.uuid===WA.state.leaderUuid?" (leader)":""}`,l.id=s.uuid;const n=document.createElement("img");n.classList.add("w-24"),n.classList.add("h-24"),n.classList.add("rounded-full"),n.src=`${r}/player-avatar.jpg`,e.appendChild(n),e.appendChild(l),t==null||t.appendChild(e)}function a(){const s=document.getElementById("characters");s&&(s.innerHTML=""),g(WA.player);const t=WA.players.list();console.log("players",t);for(const e of t)g(e)}function y(s){const t=document.getElementById("error-message");if(t==null){console.error("Error element not found");return}s!=null?t.innerText=s:t.innerText=""}function h(){const s=Array.from(WA.players.list());if(console.log("Players: ",s.length),s.length<4){y("Vous devez Ãªtre au moins 4 joueurs pour commencer la partie");return}else y(void 0);const t=s.length;let e=Math.floor(t*.2);e<1&&(e=1),console.log("Number of wolves: ",e);const l=["younGirl"];for(let o=0;o<e;o++)l.push("wolf");for(let o=0;o<t-1-e;o++)l.push("villager");console.log("Roles: ",l),l.sort(()=>Math.random()-.5),console.log("Roles shuffled: ",l);const n=[],m=[];let f="";const v=WA.player.uuid;for(let o=0;o<s.length;o++){const p=s[o],c=l[o];c==="wolf"?m.push(p.uuid):c==="villager"?n.push(p.uuid):c==="younGirl"&&(f=s[o].uuid)}WA.state.saveVariable("roles",{villagers:n,werewolfs:m,yougGirl:f,leader:v}),WA.ui.modal.closeModal()}function u(s,t){const e=document.createElement("div");e.classList.add("flex"),e.classList.add("flex-col"),e.classList.add("justify-center"),e.classList.add("items-center");const l=document.createElement("p");l.classList.add("text-white"),l.innerText=`${s} (${t})`,l.id=s;const n=document.createElement("img");switch(n.classList.add("w-24"),n.classList.add("h-24"),n.classList.add("rounded-full"),s){case i.leader:n.src=`${r}/player-avatar.jpg`,l.innerText=`Leader (${t})`;break;case i.wolf:n.src=`${r}/werewolf-illustration.jpg`,l.innerText=`Loup garou (${t})`;break;case i.villager:n.src=`${r}/villager-illustration.jpg`,l.innerText=`Villageoi (${t})`;break;case i.youggirl:n.src=`${r}/younggirl-illustration.jpg`,l.innerText=`Petite fille (${t})`;break}return e.appendChild(n),e.appendChild(l),e}function d(){const s=Array.from(WA.players.list()).length;if(Array.from(WA.players.list()).length>=4){let t=Math.floor(s*.2);t<1&&(t=1);const e=document.getElementById("game-roles");e&&(e.innerHTML="");const l=document.getElementById("game-instructions");l&&(l.innerText=`Il y a ${s} joueurs dans la partie soit 1 petite fille, ${s-t} villageois et ${t} loups garous`),e==null||e.appendChild(u(i.youggirl,1)),e==null||e.appendChild(u(i.villager,s-t)),e==null||e.appendChild(u(i.wolf,t))}else{const t=document.getElementById("game-roles");t&&(t.innerHTML="");const e=document.getElementById("game-instructions");e&&(e.innerHTML=`Il manque (${4-s}) joueurs pour commencer la partie`)}}function L(){setTimeout(()=>{a(),d(),L()},5e3)}WA.onInit().then(async()=>{if(console.info("Initiate Waiting Room"),!WA.state.startGame){WA.ui.modal.closeModal();return}const s=document.getElementById("start-game"),t=document.getElementById("start-game-button");A()?(s==null||s.classList.remove("hidden"),t==null||t.addEventListener("click",h)):(s==null||s.classList.add("hidden"),t==null||t.removeEventListener("click",h)),await WA.players.configureTracking(),setTimeout(()=>{a(),d()},E),L(),WA.players.onPlayerEnters.subscribe(()=>{a(),d()}),WA.players.onPlayerLeaves.subscribe(()=>{a(),d()})});
