import"./modulepreload-polyfill-3cfb730f.js";import"./main-4ed993c7.js";import{c as v,d as A,r,h as E}from"./main-fae65c30.js";async function p(s){const t=document.getElementById("characters"),e=document.createElement("div");e.classList.add("flex"),e.classList.add("flex-col"),e.classList.add("justify-center"),e.classList.add("items-center");const l=document.createElement("p");l.classList.add("text-white"),l.innerText=`${s.uuid===WA.player.uuid?"Vous":s.name}${s.uuid===WA.state.leaderUuid?" (leader)":""}`,l.id=s.uuid;const n=document.createElement("img");n.classList.add("w-24"),n.classList.add("h-24"),n.classList.add("rounded-full"),n.src="/player-avatar.jpg",e.appendChild(n),e.appendChild(l),t==null||t.appendChild(e)}function a(){const s=document.getElementById("characters");s&&(s.innerHTML=""),p(WA.player);const t=WA.players.list();console.log("players",t);for(const e of t)p(e)}function g(s){const t=document.getElementById("error-message");if(t==null){console.error("Error element not found");return}s!=null?t.innerText=s:t.innerText=""}function y(){const s=Array.from(WA.players.list());if(console.log("Players: ",s.length),s.length<4){g("Vous devez Ãªtre au moins 4 joueurs pour commencer la partie");return}else g(void 0);const t=s.length;let e=Math.floor(t*.2);e<1&&(e=1),console.log("Number of wolves: ",e);const l=["younGirl"];for(let o=0;o<e;o++)l.push("wolf");for(let o=0;o<t-1-e;o++)l.push("villager");console.log("Roles: ",l),l.sort(()=>Math.random()-.5),console.log("Roles shuffled: ",l);const n=[],i=[];let m="";const L=WA.player.uuid;for(let o=0;o<s.length;o++){const f=s[o],d=l[o];d==="wolf"?i.push(f.uuid):d==="villager"?n.push(f.uuid):d==="younGirl"&&(m=s[o].uuid)}WA.state.saveVariable("roles",{villagers:n,werewolfs:i,yougGirl:m,leader:L}),WA.ui.modal.closeModal()}function u(s,t){const e=document.createElement("div");e.classList.add("flex"),e.classList.add("flex-col"),e.classList.add("justify-center"),e.classList.add("items-center");const l=document.createElement("p");l.classList.add("text-white"),l.innerText=`${s} (${t})`,l.id=s;const n=document.createElement("img");n.classList.add("w-24"),n.classList.add("h-24"),n.classList.add("rounded-full");const i=`${E}/public`;switch(s){case r.leader:n.src=`${i}/player-avatar.jpg`,l.innerText=`Leader (${t})`;break;case r.wolf:n.src=`${i}/werewolf-illustration.jpg`,l.innerText=`Loup garou (${t})`;break;case r.villager:n.src=`${i}/villager-illustration.jpg`,l.innerText=`Villageoi (${t})`;break;case r.youggirl:n.src=`${i}/younggirl-illustration.jpg`,l.innerText=`Petite fille (${t})`;break}return e.appendChild(n),e.appendChild(l),e}function c(){const s=Array.from(WA.players.list()).length;if(Array.from(WA.players.list()).length>=4){let t=Math.floor(s*.2);t<1&&(t=1);const e=document.getElementById("game-roles");e&&(e.innerHTML="");const l=document.getElementById("game-instructions");l&&(l.innerText=`Il y a ${s} joueurs dans la partie soit 1 petite fille, ${s-t} villageois et ${t} loups garous`),e==null||e.appendChild(u(r.youggirl,1)),e==null||e.appendChild(u(r.villager,s-t)),e==null||e.appendChild(u(r.wolf,t))}else{const t=document.getElementById("game-roles");t&&(t.innerHTML="");const e=document.getElementById("game-instructions");e&&(e.innerHTML=`Il manque (${4-s}) joueurs pour commencer la partie`)}}function h(){setTimeout(()=>{a(),c(),h()},5e3)}WA.onInit().then(async()=>{if(console.info("Initiate Waiting Room"),!WA.state.startGame){WA.ui.modal.closeModal();return}const s=document.getElementById("start-game"),t=document.getElementById("start-game-button");v()?(s==null||s.classList.remove("hidden"),t==null||t.addEventListener("click",y)):(s==null||s.classList.add("hidden"),t==null||t.removeEventListener("click",y)),await WA.players.configureTracking(),setTimeout(()=>{a(),c()},A),h(),WA.players.onPlayerEnters.subscribe(()=>{a(),c()}),WA.players.onPlayerLeaves.subscribe(()=>{a(),c()})});
